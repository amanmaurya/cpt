<% include ./qc_header %>
<script type="text/javascript">
  $(document).ready(function () {
  var msg = <%=msg%>
  if(msg == 1){
    alert('Invalid CSV file! Please check for "Category Id 1" column ');
  }
  
});
</script>
<link href="/stylesheets/style.css" rel="stylesheet">
<div id="upload-template">
  <form action="/qc/upload" method="POST" encType="multipart/form-data">
  <div class="col-lg-12 center" style=" background-color:#f4f4f6;">

     <center> <h3>Upload Process File</h3></center>
      
  </div>
  <div class="col-lg-12" style="background-color:white;">
   <div class="col-lg-12 uptop" style="margin-top:20px" >
    <div class="col-lg-4">
      <label for="template">Upload Process File</label>
      </div>
       <div class="col-lg-8">
   <input id="csv-file" name="processedFile" type="file" class="form-control" placeholder="Upload CSV" required>
      <input type="text" name="fname" id ="csv-fname" class="hide" />
    </div>
    </div>

  
   
     <div class="col-lg-12 uptop" style="margin-top:20px" >
    <div class="col-lg-4">
      <label for="template">Upload Excel</label>
      </div>
      <div class="col-lg-8">
      <input id="excel-file" name="merchantFile" type="file" class="form-control" placeholder="Upload Excel" required>
      <input type="text" name="fname1" id ="excel-fname" class="hide" />
      </div>
    </div>
  <div class="col-lg-12 uptop" style="margin-top:20px" >
    <div class="col-lg-4">
      <label for="sheet number">Excel Sheet Number</label>
      </div>
      <div class="col-lg-8">
      <input name="sheetNumber"  oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" maxlength = "10" min = "1" max = "99999" type="number" class="form-control" placeholder="Sheet Number" required>
    </div>
    </div>
   <div class="col-lg-12 uptop" style="margin-top:20px" >
    <div class="col-lg-4">
      <label for="header row number">Header Row</label>
      </div>
        <div class="col-lg-8">
      <input name="headerNumber"  oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" maxlength = "10" min = "1" max = "99999" type="number" class="form-control" placeholder="Header Row Number" required>
    </div>
    </div>
    <div class="col-lg-12 uptop  " style="margin-top:20px">
    <div class="col-lg-4">
       <label for="header row number">Image Path</label>
      </div>
       <div class="col-lg-8">
        <input name="image_path" type="text" class="form-control" placeholder="Image Path" >
    </div>
    </div>
    <div class="col-lg-12 uptop">
   <center> <button type="submit" class="btn btn-default" style="color:#7e7e7e;background-color:#f4f4f6;width:150px;height:35px;margin-top:10px;margin-bottom:10px;">Submit</button>
   </center>
   </div>
    </div>
  </form>
</div>
<% include ./footer %>
<script type="text/javascript">
var a;
$(document).ready(function() {
  var csvFileInput = $('#csv-file');
  csvFileInput.change(function() {
    var filename=csvFileInput.val();
    var flname=filename.split('\\');
    $('#csv-fname').val(flname[flname.length-1]);
    var ext = csvFileInput.val().split('.').pop().toLowerCase();
    //a=ext;
    //alert(ext)
    if($.inArray(ext, ['xls','xlsx']) == -1) {
      alert('invalid extension! Extention could only be xls or xlsx');
      csvFileInput.val('');
    }
  });
  var fileInput = $('#excel-file');
  fileInput.change(function() {
    var filename=fileInput.val();
    var flname=filename.split('\\');
    $('#excel-fname').val(flname[flname.length-1]);
    var ext = fileInput.val().split('.').pop().toLowerCase();
    if($.inArray(ext, ['xls','xlsx']) == -1) {
      alert('invalid extension! Extention could only be xls or xlsx');
      fileInput.val('');
    }
  });
});
</script>

<style>
label{
      line-height: 32px !important;
}
</style>